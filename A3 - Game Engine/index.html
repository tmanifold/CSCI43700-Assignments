<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <title>Game Engine Demo</title>

        <script type="text/javascript" src="./js/engine.js"></script>
        <script type="text/javascript" src="./js/utility.js"></script>

        <script type="text/javascript">

            function checkKeys(sp) {
                kb = scene.kb;

                if (kb.keys['w']) {
                    sp.addForce(new Vector2(0, -1));
                }
                if (kb.keys['a']) {
                    sp.addForce(new Vector2(-1, 0));
                }
                if (kb.keys['s']) {
                    sp.addForce(new Vector2(0, 1));
                }
                if (kb.keys['d']) {
                    sp.addForce(new Vector2(1, 0));
                }
            }

            function spawnBurger(scene) {

                let burger = new Sprite('./img/burger.png', scene, 50, 50, getRandomInt(scene.width), getRandomInt(scene.height));
                let vmax = 10;
                let x = getRandomInt(vmax);
                let y = getRandomInt(vmax);
                burger.addForce(new Vector2(x, y));
                // FIGURE OUT ROATION
            }

            // https://stackoverflow.com/a/13455101
            function getRandomInt(max) {
                return Math.ceil(Math.random() * max) * (Math.round(Math.random()) ? 1 : -1);
            }

            function init() {

                setDebugMode(DEBUG.ON);

                scene = new Scene('demo');
                scene.setBorder("1px solid gray");

                Cow = new Sprite('./img/livestock/cow side.png', scene, 50, 50, scene.width / 2, scene.height / 2);


                document.getElementById("btnSceneStart").onclick = scene.start;
                document.getElementById("btnSceneStop").onclick = scene.stop;

                //sp = new Sprite('./img/burger.png', scene, 50, 50, 50, 100);
                //sp.addForce(new Vector2(5, 0));
                //sp.setBoundAction(Sprite.BOUND_ACTION.BOUNCE);

                //sp2 = new Sprite('./img/burger.png', scene, 50, 50, 300, 100);
                //sp2.addForce(new Vector2(-5, 0));

                for (let i = 0; i < 5; i++) {
                    spawnBurger(scene);
                }

                scene.start();

                // t = new Timer(() => {
                //     console.log("timer done.");
                // }, 100 * 1000);
                //
                // document.getElementById("btnTimerStart").onclick = t.start.bind(t);
                // document.getElementById("btnTimerStop").onclick = t.stop.bind(t);
                // document.getElementById("btnTimerPause").onclick = t.pause.bind(t);
            }

            function update() {
                //document.getElementById("timer").innerHTML = t.time / 1000;

                this.checkKeys(Cow);

                scene.clear();

                for (const sprite of scene.sprites) {
                    //sprite.rotateImageAngle(0.5);
                    sprite.update();
                }
            }

        </script>
    </head>

    <body onload="init()">

        <h3> Game Engine Demo</h3>

        Timer: <label id="timer">time</label><br />
        <button id="btnTimerStart">Start</button>
        <button id="btnTimerStop">Stop</button>
        <button id="btnTimerPause">Pause</button>
        <div id="demo" style="border: 1px solid red; padding:10px;"></div>

        <div id="debugConsole" style="border: 1px solid red; padding: 10px; margin-top: 10px;">
            Debug<br />

            <button id="btnSceneStart">Start Scene</button><button id="btnSceneStop">Stop Scene</button>
        </div>

    </body>

</html>
